@using Mari.Contracts.Releases
@using Mari.Contracts.Common.Interfaces
@attribute [Route(ClientRoutes.Pages.ReleasesInfo)] //
<!-- Потом добавить ещё id релиза -->
@inject IReleaseManager ReleaseManager

<MudPaper Elevation="3" Height="100vh">

    <MudContainer Class="my-auto" MaxWidth="MaxWidth.Medium" Style="display: flex; flex-direction: row;">

        <!-- Хм минимальная ширина? -->

        <MudContainer MaxWidth="MaxWidth.Medium" Style="display: flex; flex-direction: column;">

            <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="BackButtonClick"
                Href="@ClientRoutes.Pages.Index">Вернуться</MudButton>


            <MudContainer MaxWidth="MaxWidth.Medium" Class="mt-5 d-flex justify-space-between">
                <MudContainer>
                    <MudText Typo="Typo.h5">Платформа: @Release.PlatformName</MudText>
                </MudContainer>
                <MudContainer Class=" d-flex flex-row-reverse">
                    <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="RightDrawerButtonOnClick">
                        Дополнительно</MudButton>
                    <MudIconButton Title="Редактировать" Class="mr-4" Icon="@Icons.Filled.Edit"
                        OnClick="ClickOnEditingRelease" Variant="Variant.Filled" Color="Color.Primary"
                        Size="Size.Medium" />
                </MudContainer>

            </MudContainer>

            <MudContainer MaxWidth="MaxWidth.Medium" Class="my-5" Style="display: flex; flex-direction: row;">

                <MudContainer Class="px-0" MaxWidth="MaxWidth.Medium" Style="display: flex; flex-direction: column;">
                    <MudText>Версия: @Release.Version</MudText>
                    <MudText>Релиз задача: url</MudText>
                    <MudText>Статус: @Release.Status</MudText>
                </MudContainer>

                <MudContainer MaxWidth="MaxWidth.Medium"
                    Style="display: flex; flex-direction: column; justify-content: space-between">
                    <MudText>Дата изменения: @Release.UpdateDate</MudText>
                    <MudText>Дата завершения: @Release.CompleteDate</MudText>
                </MudContainer>
            </MudContainer>

            <MudContainer MaxWidth="MaxWidth.Medium">
                <MudText Typo="Typo.h5">Информация о релизе при его создании (Фио создателя релиза)</MudText>
            </MudContainer>

            <MudContainer MaxWidth="MaxWidth.Medium" Style="display: flex; flex-direction: column;" Class="my-3">
                <MudText>@Release.Information </MudText>
            </MudContainer>


            <MudDrawer @bind-Open="IsRightDrawerOpened" Width="400px" Anchor="Anchor.Right">
                <MenuRelease ReleaseStatus="@Release.Status" ClickOnEditingRelease="ClickOnEditingRelease" />
            </MudDrawer>
        </MudContainer>

    </MudContainer>
</MudPaper>

@if (openEditingRelease)
{
    <CardEditRelease Release="Release" ClickOnEditingRelease="ClickOnEditingRelease" />
}

@code {


    [Parameter]
    public string ReleaseId { get; set; }

    private bool IsRightDrawerOpened { get; set; } = false;
    private bool openEditingRelease { get; set; } = false;

    private ReleaseAnswer Release { get; set; }


    /*private ReleaseAnswer Release { get; set; } = new ReleaseAnswer(
    "1.1.1", "Testing", "10.11.2022", "Android", "10.11.2022",
    "В целом, конечно, укрепление и развитие внутренней структуры создаёт предпосылки для экономической");*/

    public void ClickOnEditingRelease()
    {
        IsRightDrawerOpened = false;
        openEditingRelease = !openEditingRelease;
    }

    private void BackButtonClick()
    {
        IsRightDrawerOpened = false;
    }

    private void RightDrawerButtonOnClick()
    {
        IsRightDrawerOpened = !IsRightDrawerOpened;
    }


    protected override async Task OnInitializedAsync()
    {
        var release = await ReleaseManager.Get(null);
        Release = release;

    }
    /*var release = await Client.GetFromJsonAsync<ReleaseAnswer>(Routes.Server.ReleaseController); */
    // Release = release;



}